<template>
  <layout>
    <template #section-right-content>
      <div class="activity_info">
        <!-- <div class="activity_info-post">
            <input type="text" />
          </div> -->
        <h1>{{ activityData.ACTIVITY_NAME }}</h1>
        <div class="act_ph">
          <img
            src="../assets/images/actitity/001.jpg"
            alt="å¤æ—¥éŸ³æ¨‚ç¥­"
            class="activity_ph"
          />
        </div>

        <h1>æ´»å‹•è³‡è¨Š</h1>
        <div>
          <p>æ´»å‹•åç¨±: {{ activityData.ACTIVITY_NAME }}</p>
          <p>æ´»å‹•åœ°å€: {{ activityData.ACTIVITY_ADDRESS }}</p>
          <p>æ´»å‹•æ—¥æœŸ: {{ activityData.ACTIVITY_DATE }}</p>
          <p>å ±åæˆªæ­¢æ—¥æœŸæ™‚é–“: {{ activityData.ACTIVITY_ENDDATE }}</p>
          <p>æ´»å‹•æè¿°: {{ activityData.ACTIVITY_DESCRIBE }}</p>
          <p>æ´»å‹•åé¡: {{ activityData.ACTIVITY_QUOTA }}</p>
          <p>å–®äººé‡‘é¡: {{ activityData.ACTIVITY_SINGLE_PRICE }}</p>
          <p>åœ˜å ±é‡‘é¡: {{ activityData.ACTIVITY_GROUP_PRICE }}</p>
          <p>å‰©é¤˜åé¡: {{ activityData.REMAINING_PLACES }}</p>
        </div>

        <div class="act-content">
          <div class="content-top">
            <div class="content-top-L">
              <div class="content-top-L-1">
                <span>
                  <img
                    src="../assets/images/actitity/location-outline.svg"
                    alt="æ´»å‹•åœ°å€"
                /></span>
                {{ activityData.ACTIVITY_ADDRESS }}
              </div>
              <div class="content-top-L-2">
                <span
                  ><img
                    src="../assets/images/actitity/Date.svg"
                    alt="æ´»å‹•æ—¥æœŸ"
                  /> </span
                >{{ activityData.ACTIVITY_DATE }}
              </div>
              <div class="content-top-L-3">
                <div class="content-top-L-3-1">
                  <span
                    ><img
                      src="../assets/images/actitity/æˆªæ­¢æ™‚é–“.svg"
                      alt="å ±åæˆªæ­¢"
                  /></span>
                  {{ activityData.ACTIVITY_ENDDATE }} æˆªæ­¢å ±å
                </div>
                <div class="content-top-L-3-2">
                  <span
                    ><img
                      src="../assets/images/actitity/äººæ•¸.svg"
                      alt="æ´»å‹•åé¡"
                  /></span>
                  åé¡{{ activityData.ACTIVITY_QUOTA }}äºº(å‰©é¤˜åé¡:
                  {{ activityData.REMAINING_PLACES }}äºº)
                </div>
              </div>
              <div class="content-top-L-4">
                <span>
                  <img
                    src="../assets/images/actitity/è²»ç”¨.svg"
                    alt="æ´»å‹•è²»ç”¨"
                  />
                </span>
                1äºº${{ activityData.ACTIVITY_SINGLE_PRICE }}/äºº 3äºº${{
                  activityData.ACTIVITY_GROUP_PRICE
                }}/äºº
              </div>
            </div>
            <div class="content-top-R">
              <div id="btn">
                <!-- è§¸ç™¼æŒ‰éˆ• -->
                <button @click="showModal = true" class="btn btn-dark">
                  æˆ‘è¦å ±å
                </button>
                <!-- å½ˆè·³è¦–çª— -->
                <div v-if="showModal" class="modal" @click="closeModal2">
                  <!-- å½ˆè·³è¦–çª—å…§å®¹ -->
                  <div class="modal-content" @click.stop>
                    <span
                      class="close"
                      @click="
                        showModal = false;
                        closeModal2();
                      "
                      >&times;</span
                    >
                    <div v-if="contentChanged" class="if">
                      <div>
                        <p class="list2-m">å ±åæˆåŠŸ</p>
                        <div class="list2-n">
                          <div>ç‹å°æ˜</div>
                          <div>
                            <img
                              src="../assets/images/actitity/å°æ˜.svg"
                              alt="å°æ˜è‡ªæ‹ç…§"
                            />
                          </div>
                        </div>
                        <div class="list2-f">
                          <div class="list2">
                            <div class="gp-1">
                              <span class="list2-1">æ´»å‹•åç¨±</span
                              ><span class="list2-1-2">{{
                                activityData.ACTIVITY_NAME
                              }}</span>
                            </div>
                            <div class="gp-2">
                              <span class="list2-2">æ´»å‹•æ—¥æœŸ</span
                              ><span class="list2-2-2">2023/12/25</span>
                            </div>
                            <div class="gp-3">
                              <span class="list2-3">å ±åäººæ•¸</span
                              ><span class="list2-3-2">1äºº</span>
                            </div>
                            <div class="gp-4">
                              <span class="list2-4">ç¸½é‡‘é¡</span
                              ><span class="list2-4-2"> $1000/äºº</span>
                            </div>
                          </div>
                          <div class="gp-4">
                            <p class="list2-check">
                              æ‚¨å·²ç¶“ä»˜æ¬¾å ±åæˆåŠŸï¼Œä»¥ä¸Šæ˜¯æ‚¨çš„æªåœ˜è³‡è¨Šã€‚
                            </p>
                            <!-- ç•¶é€£çµè¢«é»æ“Šæ™‚ï¼Œèª¿ç”¨ checkBeforeNavigate æ–¹æ³• -->
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- @@@@@@@@@@@@@@@@@ -->
                    <div v-else class="else">
                      <div>
                        <p class="list-m">å ±åè³‡è¨Š</p>
                        <div class="list-n">
                          <div>ç‹å°æ˜</div>
                          <div>
                            <img
                              src="../assets/images/actitity/å°æ˜.svg"
                              alt="å°æ˜è‡ªæ‹ç…§"
                            />
                          </div>
                        </div>
                        <div class="list">
                          <div class="list-L">
                            <div class="group-1">
                              <span class="list-1">æ´»å‹•åç¨±</span
                              ><span class="list-1-2">{{
                                activityData.ACTIVITY_NAME
                              }}</span>
                            </div>
                            <div class="group-2">
                              <span class="list-2">æ´»å‹•æ—¥æœŸ</span
                              ><span class="list-2-2">
                                {{ activityData.ACTIVITY_DATE }}</span
                              >
                            </div>
                            <div class="group-3">
                              <span class="list-3">å ±åäººæ•¸</span
                              ><span class="list-3-2">
                                <input
                                  type="number"
                                  v-model.number="quantity"
                                  @input="validateQuantity"
                                  placeholder="è«‹è¼¸å…¥äººæ•¸"
                              /></span>
                            </div>
                            <div class="group-4">
                              <span class="list-4">ç¸½é‡‘é¡</span
                              ><span class="list-4-2">
                                <label
                                  v-if="quantity !== null && quantity !== ''"
                                >
                                  {{ total }}/äºº
                                </label></span
                              >
                            </div>
                          </div>
                        </div>
                        <div class="list-check">
                          <input
                            type="checkbox"
                            id="agree"
                            v-model="isChecked"
                          />
                          <label for="agree">
                            æˆ‘å·²é–±è®€ä¸¦åŒæ„éµå®ˆæœ¬ç¶²ç«™çš„ä½¿ç”¨
                            <span class="link" @click="goToItem1">æ¢æ¬¾</span>å’Œ
                            <span class="link" @click="goToItem2"
                              >éš±ç§æ”¿ç­–</span
                            ></label
                          >
                          <!-- ç•¶é€£çµè¢«é»æ“Šæ™‚ï¼Œèª¿ç”¨ checkBeforeNavigate æ–¹æ³• -->
                        </div>
                      </div>
                      <!-- @@@@@@@@@@@@@@@@@ -->

                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-dark btn-center"
                          @click="changeContent()"
                          :disabled="!isChecked"
                        >
                          å‰å¾€çµå¸³
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="content-bottom">
            <div class="b-t">
              <br />
              <div>ç‚ç‚å¤æ—¥ï¼Œèˆ‡éŸ³æ¨‚ç›¸é‡ï¼</div>
              <div>
                å¤æ—¥çš„é¢¨ï¼Œç†±æƒ…çš„é™½å…‰ï¼Œå’Œä½ æœ€æ„›çš„æ—‹å¾‹ï¼Œ2023å¤æ—¥éŸ³æ¨‚ç¥­é‚€è«‹ä½ ä¸€åŒä¾†å ´éŸ³æ¨‚çš„æ´¾å°ï¼
              </div>
              <br />
              <div class="b-b">
                <div class="b-b1">
                  <span
                    ><img
                      src="../assets/images/actitity/ğŸ¤æ´»å‹•1-å…§å®¹icon(1).svg"
                      alt="çŸ¥åæ­Œæ‰‹" /></span
                  >åœ‹å…§å¤–çŸ¥åæ­Œæ‰‹ç¾å ´æ¼”å‡º
                </div>
                <div class="b-b2">
                  <span
                    ><img
                      src="../assets/images/actitity/ğŸ¹æ´»å‹•1-å…§å®¹icon(2).svg"
                      alt="ç¾é£Ÿ" /></span
                  >ç¾é£Ÿå’Œé£²å“æ”¤ä½ï¼Œè®“ä½ çš„å‘³è•¾ä¹Ÿä¾†å ´ç››å®´
                </div>
                <div class="b-b3">
                  <span
                    ><img
                      src="../assets/images/actitity/ğŸ’ƒæ´»å‹•1-å…§å®¹icon(3).svg"
                      alt="èˆæ± " /></span
                  >ç¾å ´DJå’Œèˆæ± ï¼Œè®“ä½ èˆå‹•å¤æ—¥
                </div>
                <div class="b-b4">
                  <span
                    ><img
                      src="../assets/images/actitity/ğŸ¨æ´»å‹•1-å…§å®¹icon(4).svg"
                      alt="éŠæˆ²" /></span
                  >è—è¡“è£ç½®å’Œäº’å‹•éŠæˆ²ï¼Œè®“ä½ èˆ‡æœ‹å‹ç•™ä¸‹ç¾å¥½å›æ†¶
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </template>
  </layout>
</template>

<script>
import layout from "@/components/layout.vue";
import axios from "axios";
export default {
  components: {
    layout,
  },
  data() {
    return {
      showModal: false,
      quantity: null, // åˆä¸¦data
      amount: 1200, // å‡è¨­åˆå§‹è²»ç”¨ç‚º1200
      contentChanged: false,
      isChecked: false,
      activityData: {
        ACTIVITY_NAME: "",
        ACTIVITY_ADDRESS: "",
        ACTIVITY_DATE: "",
        ACTIVITY_ENDDATE: "",
        ACTIVITY_DESCRIBE: "",
        ACTIVITY_QUOTA: "",
        ACTIVITY_SINGLE_PRICE: "",
        ACTIVITY_GROUP_PRICE: "",
        REMAINING_PLACES: "",
      },
      data: null,
      loading: false,
    };
  },
  mounted() {
    this.getActivityData();
  },
  methods: {
    closeModal(event) {
      if (event.target.classList.contains("modal")) {
        this.showModal = false;
      }
    },
    closeModal2() {
      this.showModal = false;
      this.contentChanged = false; // é‡ç½®å…§å®¹ç‹€æ…‹
    },
    validateQuantity() {
      if (this.quantity < 0) {
        this.quantity = 0;
      } else if (this.quantity >= 3) {
        this.amount = 1000; // å¦‚æœäººæ•¸è¶…é3ï¼Œè²»ç”¨è®Šæ›´
      } else {
        this.amount = 1200; // å¦‚æœäººæ•¸å°‘æ–¼3ï¼Œè²»ç”¨æ¢å¾©
      }
    },
    changeContent() {
      this.contentChanged = true;
    },
    checkBeforeNavigate() {
      if (this.checked) {
        // window.location.href = "https://www.";
      } else {
        // å¦‚æœæœªå‹¾é¸ï¼Œé¡¯ç¤ºæé†’
        alert("è«‹å…ˆå‹¾é¸åŒæ„æ¢æ¬¾å’Œæ¢ä»¶ã€‚");
      }
    },

    goToItem1() {
      window.location.href = "https://www.google.com"; // æ›¿æ›æˆå¯¦éš›çš„æ¢æ¬¾é é¢ URL
    },
    goToItem2() {
      window.location.href = "https://edition.cnn.com/"; // æ›¿æ›æˆå¯¦éš›çš„éš±ç§æ”¿ç­–é é¢ URL
    },
    handleButtonClick() {
      if (this.isChecked) {
        // åŸ·è¡Œä¸€äº›æ“ä½œï¼Œå› ç‚º checkbox å·²ç¶“è¢«å‹¾é¸
        alert("Checkbox is checked. Proceeding with the action.");
      } else {
        // æé†’ç”¨æˆ¶å‹¾é¸ checkbox
        alert("Please check the checkbox first.");
      }
    },
    getActivityData() {
      axios
        .get("http://localhost:80/group-ts/TS/getUserData.php")
        .then((response) => {
          console.log(response.data); // è¼¸å‡ºæŸ¥çœ‹æ•¸æ“š
          this.activityData = response.data;
        })
        .catch((error) => {
          console.error(
            "There was an error fetching the activity data: ",
            error
          );
        });
    },
  },
  computed: {
    total() {
      // ç•¶æ²’æœ‰è¼¸å…¥æ™‚ï¼Œç¸½é‡‘é¡ä¸è¨ˆç®—
      return this.quantity !== null && this.quantity !== ""
        ? this.quantity * this.amount
        : 0;
    },
  },
};
</script>
